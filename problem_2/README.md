# Problem 2: Even Fibonacci Numbers

**Problem source:** [Project Euler Problem 2](https://projecteuler.net/problem=2)

**Problem statement:**

Each new term in the **Fibonacci sequence** is generated by adding the previous two terms. By starting with $1$ and $2$, the first $10$ terms will be: $1, 2, 3, 5, 8, 13, 21, 34, 55, 89, \dots$.

By considering the terms in the Fibonacci sequence whose values do not exceed four million, find the sum of the **even-valued terms**.

## Solution 1

### Approach

  - Generate the Fibonacci sequence iteratively, starting with $0$ and $1$.
  - In each step, check if the newly generated term is even.
  - If the term is even, add it to a running sum.
  - Stop when the generated term exceeds the threshold of four million.

**Reference:** The full Python implementation is available in [`solution_1.py`](https://www.google.com/search?q=solution_1.py).

### Detailed Explanation

  - **Step 1: Initialization**
      - Initialize `previous = 0` and `current = 1` to start the sequence generation.
      - Initialize `sum = 0` and `threshold = 4000000`.
  - **Step 2: Iteration and Sequence Generation**
      - The `while current < threshold:` loop continues as long as the current Fibonacci number is below four million.
      - Inside the loop, the next Fibonacci number is calculated: `previous, current = current, previous + current`. The old `current` becomes the new `previous`, and the sum of the old `previous` and `current` becomes the new `current`.
  - **Step 3: Check for Even Numbers**
      - We check the new `previous` (which is the old `current`, the term *just added* to the sequence) for evenness using modular arithmetic: `if not previous % 2:`.
  - **Step 4: Accumulating the sum**
      - If the term is even, it is added to the running `sum`.

-----

## Solution 2

### Approach

  - Exploit the property that **every third Fibonacci number is even**.
      - The sequence pattern is: $\text{odd}, \text{even}, \text{odd}, \text{even}, \text{odd}, \text{even}, \dots$
  - Use the modified recurrence relation for **even Fibonacci numbers** $E_n$:
    $$E_{n} = 4 \cdot E_{n-1} + E_{n-2}$$
  - This allows for the generation of *only* the even terms, significantly reducing the number of iterations.
  - Iterate using this modified recurrence relation and sum the terms until the threshold is exceeded.

**Reference:** The full Python implementation is available in [`solution_2.py`](https://www.google.com/search?q=solution_2.py).

### Detailed Explanation

  - **Step 1: Modified Initialization**
      - Initialize `previous = 0` and `current = 2` to correctly seed the even-term recurrence.
  - **Step 2: Modified Recurrence**
      - The relation $E_{n} = 4 \cdot E_{n-1} + E_{n-2}$ is implemented as: `previous, current = current, previous + 4 * current`.
      - The terms generated are $2, 8, 34, 144, \dots$ which are exactly the even terms.
  - **Step 3: Accumulating the sum**
      - The new `previous` (the term *just added* to the sequence) is added to the running `sum` in each iteration.
  - **Efficiency:** This method is much faster than Solution 1, performing only $\approx \frac{1}{3}$ the number of steps.

-----

## Solution 3

### Approach

  - Use **Binet's Formula** to find the $n$-th even Fibonacci number directly.
  - The $n$-th even Fibonacci number is $E_n = F_{3n}$, which can be expressed using the Golden Ratio $\phi$:
    $$E_n = \frac{(\phi^3)^n - (\psi^3)^n}{\sqrt{5}}$$
  - Calculate the index $N$ of the last even term below the threshold.
  - Use the **formula for the sum of a geometric series** to sum all $N$ terms directly, resulting in an $\mathcal{O}(1)$ solution.

**Reference:** The full Python implementation is available in [`solution_3.py`](https://www.google.com/search?q=solution_3.py).

### Detailed Explanation

  - **Step 1: Finding the index $N$**
      - The code iteratively solves for the smallest $N$ such that $E_N \ge 4,000,000$. The index $N-1$ is the last term to be summed.
  - **Step 2: Sum of Geometric Series**
      - The total sum $\sum_{n=1}^{N} E_n$ is a sum of two geometric series derived from Binet's formula components.
      - The sum formula $S_N = \frac{a(r^N - 1)}{r - 1}$ is applied to the $\phi^3$ and $\psi^3$ parts.
  - **Step 3: Final Calculation**
      - The final sum is calculated as:
        $$\text{sum\_even} = \frac{\sum (\phi^3)^n - \sum (\psi^3)^n}{\sqrt{5}}$$
      - The result is then rounded to the nearest integer to achieve the exact sum, compensating for floating-point calculations.
  - **Efficiency:** This is the **most efficient** solution as it avoids a sequential loop over the Fibonacci terms.

## Output

```
4613732
```

-----

## Notes

  - The problem uses the sequence starting $1, 2, 3, 5, \dots$. If using the standard mathematical indexing $F_1=1, F_2=1, F_3=2, \dots$, the terms used here are $F_2, F_3, F_4, \dots$.
  - **Solution 2** is the optimal iterative method, while **Solution 3** is the most efficient, closed-form approach.
